saving to: ./pth_file/best_WH_DW_tentwo3whnum467vit_decoderRDDwhpaper256.pth
train size: 371
val size: 500
save on epochs:  [0, 24, 49, 74, 99, 124, 149, 174, 199, 224, 249, 274, 299, 324, 349, 374, 399, 424, 449, 474, 499, 524, 549, 574, 599, 624, 649, 674, 699, 724, 749, 774, 799, 824, 849, 874, 899, 924, 949, 974, 999, 1024, 1049, 1074, 1099, 1124, 1149, 1174, 1199, 1224, 1249, 1274, 1299, 1324, 1349, 1374, 1399, 1424, 1449, 1474, 1499, 1524, 1549, 1574, 1599, 1624, 1649, 1674, 1699, 1724, 1749, 1774, 1799, 1824, 1849, 1874, 1899, 1924, 1949, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999]
epoch: 0
build epoch
Traceback (most recent call last):
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 273, in <module>
    train_one(config)
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 191, in train_one
    average_loss=train_one_epoch(model, loss_fun, optimizer, train_loader, lr_scheduler, print_every=train_print_every, mixed_precision=mixed_precision, scaler=scaler)
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 77, in train_one_epoch
    output = model(image)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/model.py", line 518, in forward
    x=self.decoder(x)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/block_decoderpaper.py", line 697, in forward
    x32 = self.x32(x32)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/block_decoderpaper.py", line 21, in forward
    x = self.conv(x)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 256, 1, 1], expected input[8, 512, 16, 32] to have 256 channels, but got 512 channels instead
saving to: ./pth_file/best_WH_DW_tentwo3whnum467vit_decoderRDDwhpaper256_2.pth
train size: 371
val size: 500
save on epochs:  [0, 24, 49, 74, 99, 124, 149, 174, 199, 224, 249, 274, 299, 324, 349, 374, 399, 424, 449, 474, 499, 524, 549, 574, 599, 624, 649, 674, 699, 724, 749, 774, 799, 824, 849, 874, 899, 924, 949, 974, 999, 1024, 1049, 1074, 1099, 1124, 1149, 1174, 1199, 1224, 1249, 1274, 1299, 1324, 1349, 1374, 1399, 1424, 1449, 1474, 1499, 1524, 1549, 1574, 1599, 1624, 1649, 1674, 1699, 1724, 1749, 1774, 1799, 1824, 1849, 1874, 1899, 1924, 1949, 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999]
epoch: 0
build epoch
Traceback (most recent call last):
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 273, in <module>
    train_one(config)
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 191, in train_one
    average_loss=train_one_epoch(model, loss_fun, optimizer, train_loader, lr_scheduler, print_every=train_print_every, mixed_precision=mixed_precision, scaler=scaler)
  File "/home/stua/wh/CLReg_prog/trainwh7.py", line 77, in train_one_epoch
    output = model(image)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/model.py", line 518, in forward
    x=self.decoder(x)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/block_decoderpaper.py", line 697, in forward
    x32 = self.x32(x32)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/wh/CLReg_prog/block_decoderpaper.py", line 21, in forward
    x = self.conv(x)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 447, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/stua/.conda/envs/wh_reg/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 443, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 256, 1, 1], expected input[8, 512, 16, 32] to have 256 channels, but got 512 channels instead
